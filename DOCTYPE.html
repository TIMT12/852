DOCTYPE.html
<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç’°ä¿ç”Ÿæ´»ç¢³æ’æ”¾è¿½è¹¤å™¨</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "å¾®è»Ÿæ­£é»‘é«”", Arial, sans-serif;
    }
    body {
      background-color: #f5f5f5;
      color: #333;
      line-height: 1.6;
    }
    header {
      background-color: #4CAF50;
      color: white;
      padding: 1rem;
      /* å–æ¶ˆé è¨­ç½®ä¸­ï¼Œä½¿ç”¨ Flex é€²è¡Œå·¦å³å°é½Š */
    }
    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .auth-buttons a {
      color: white;
      text-decoration: none;
      margin-left: 1rem;
      background: rgba(255, 255, 255, 0.2);
      padding: 0.5rem 1rem;
      border-radius: 4px;
    }
    .auth-buttons a:hover {
      background: rgba(255, 255, 255, 0.4);
    }
    nav {
      background-color: #388E3C;
      display: flex;
      justify-content: center;
    }
    nav a {
      color: white;
      text-decoration: none;
      padding: 1rem;
      display: inline-block;
    }
    nav a:hover {
      background-color: #2E7D32;
    }
    .container {
      max-width: 1200px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    .card {
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      padding: 1.5rem;
      margin-bottom: 2rem;
    }
    h2 {
      color: #388E3C;
      margin-bottom: 1rem;
      border-bottom: 2px solid #4CAF50;
      padding-bottom: 0.5rem;
    }
    form {
      margin-bottom: 1rem;
    }
    .form-group {
      margin-bottom: 1rem;
    }
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: bold;
    }
    select, input {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1rem;
    }
    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 0.7rem 1.5rem;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1rem;
    }
    button:hover {
      background-color: #388E3C;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    table, th, td {
      border: 1px solid #ddd;
    }
    th, td {
      padding: 0.7rem;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    .plant-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 1rem;
    }
    .plant-card {
      background-color: white;
      border-radius: 8px;
      padding: 1rem;
      text-align: center;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    .plant-icon {
      font-size: 3rem;
      margin-bottom: 0.5rem;
    }
    .stats {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1rem;
    }
    .stat-box {
      background-color: #E8F5E9;
      padding: 1rem;
      border-radius: 8px;
      text-align: center;
      flex: 1;
      margin: 0 0.5rem;
    }
    .stat-number {
      font-size: 1.5rem;
      font-weight: bold;
      color: #388E3C;
    }
    .daily-task {
      display: flex;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    .task-checkbox {
      margin-right: 1rem;
      width: auto;
    }
    .section {
      display: none;
    }
    .section.active {
      display: block;
    }
    #exchangeSection .exchange-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #ddd;
      padding: 1rem 0;
    }
    #exchangeSection .exchange-item img {
      width: 50px;
      height: 50px;
      object-fit: cover;
      border-radius: 50%;
      margin-right: 1rem;
    }
    #exchangeSection .item-details {
      flex: 1;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <h1>ç’°ä¿ç”Ÿæ´»ç¢³æ’æ”¾è¿½è¹¤å™¨</h1>
      <div class="auth-buttons">
        <a href="login.html" class="login-btn">ç™»å…¥</a>
        <a href="register.html" class="register-btn">è¨»å†Š</a>
    </div>
  </header>
  <div id="register-page"></div>

  <nav>
    <a href="#" onclick="showSection('calculatorSection')">ç¢³æ’æ”¾è¨ˆç®—</a>
    <a href="#" onclick="showSection('recordSection')">è¨˜éŒ„æŸ¥è©¢</a>
    <a href="#" onclick="showSection('exchangeSection')">ç©åˆ†å…Œæ›</a>
    <a href="#" onclick="showSection('plantSection')">æ¤ç‰©å¯¶å…¸</a>
    <a href="#" onclick="showSection('taskSection')">æ¯æ—¥ä»»å‹™</a>
  </nav>
  <!-- å¼•å…¥ Vite æ‰“åŒ…ç”Ÿæˆçš„ React æ‡‰ç”¨ç¨‹å¼ -->
  <script type="module" src="/main.jsx"></script>
  <div class="container">
        <div class="stats">
            <div class="stat-box">
                <div class="stat-number" id="totalCarbonStat">0</div>
                <div>ç¸½ç¢³æ’æ”¾é‡ (kg)</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="pointsStat">0</div>
                <div>å¯ç”¨ç©åˆ†</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="plantsCollectedStat">0</div>
                <div>å·²æ”¶é›†æ¤ç‰©</div>
            </div>
        </div>
        
        <!-- ç¢³æ’æ”¾è¨ˆç®—å€å¡Š -->
        <div id="calculatorSection" class="section active card">
            <h2>ç¢³æ’æ”¾è¨ˆç®—</h2>
            <form id="calculatorForm">
                <div class="form-group">
                    <label for="itemType">é¸æ“‡é …ç›®:</label>
                    <select id="itemType" required>
                        <option value="">è«‹é¸æ“‡é …ç›®</option>
                        <option value="cup">ç´™æ¯</option>
                        <option value="bag">å¡‘è† è¢‹</option>
                        <option value="spoon">å¡‘è† æ¹¯åŒ™</option>
                        <option value="bottle">å¯¶ç‰¹ç“¶</option>
                        <option value="straw">å¡‘è† å¸ç®¡</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="quantity">æ•¸é‡:</label>
                    <input type="number" id="quantity" min="1" value="1" required>
                </div>
                
                <div class="form-group">
                    <label for="date">æ—¥æœŸ:</label>
                    <input type="date" id="date" required>
                </div>
                
                <button type="submit">è¨ˆç®—ä¸¦è¨˜éŒ„</button>
            </form>
            
            <div id="resultArea">
                <h3>è¨ˆç®—çµæœ:</h3>
                <p id="carbonResult">è«‹é¸æ“‡é …ç›®ä¸¦è¼¸å…¥æ•¸é‡é€²è¡Œè¨ˆç®—ã€‚</p>
            </div>
        </div>
        
        <!-- è¨˜éŒ„æŸ¥è©¢å€å¡Š -->
        <div id="recordSection" class="section card">
            <h2>ç¢³æ’æ”¾è¨˜éŒ„</h2>
            
            <div class="form-group">
                <label for="recordDate">é¸æ“‡æ—¥æœŸ:</label>
                <input type="date" id="recordDate">
                <button type="button" onclick="filterRecords()">æŸ¥è©¢</button>
            </div>
            
            <table id="recordTable">
                <thead>
                    <tr>
                        <th>æ—¥æœŸ</th>
                        <th>é …ç›®</th>
                        <th>æ•¸é‡</th>
                        <th>ç¢³æ’æ”¾é‡ (kg)</th>
                    </tr>
                </thead>
                <tbody id="recordTableBody">
                    <!-- è¨˜éŒ„å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3" style="text-align: right;"><strong>ç¸½è¨ˆ:</strong></td>
                        <td id="totalCarbon">0 kg</td>
                    </tr>
                </tfoot>
            </table>
        </div>
        
        <!-- ç©åˆ†å…Œæ›å€å¡Š -->
        <div id="exchangeSection" class="section card">
            <h2>ç©åˆ†å…Œæ›</h2>
            <p>æ‚¨ç›®å‰æ“æœ‰ <span id="currentPoints">0</span> ç©åˆ†</p>
            
            <div class="exchange-item">
                <div>ğŸŒ±</div>
                <div class="item-details">
                    <h3>è˜‹æœæ¨¹</h3>
                    <p>æ¯å¹´å¯å¸æ”¶ç´„20kgäºŒæ°§åŒ–ç¢³</p>
                </div>
                <div>
                    <span>30 ç©åˆ†</span>
                    <button onclick="exchangePlant('apple-tree', 30, 'ğŸ')">å…Œæ›</button>
                </div>
            </div>
            
            <div class="exchange-item">
                <div>ğŸŒ±</div>
                <div class="item-details">
                    <h3>æ©¡æ¨¹</h3>
                    <p>æ¯å¹´å¯å¸æ”¶ç´„40kgäºŒæ°§åŒ–ç¢³</p>
                </div>
                <div>
                    <span>50 ç©åˆ†</span>
                    <button onclick="exchangePlant('oak-tree', 50, 'ğŸŒ³')">å…Œæ›</button>
                </div>
            </div>
            
            <div class="exchange-item">
                <div>ğŸŒ±</div>
                <div class="item-details">
                    <h3>å‘æ—¥è‘µ</h3>
                    <p>ç¾éº—çš„èŠ±æœµèƒ½æ·¨åŒ–ç©ºæ°£</p>
                </div>
                <div>
                    <span>10 ç©åˆ†</span>
                    <button onclick="exchangePlant('sunflower', 10, 'ğŸŒ»')">å…Œæ›</button>
                </div>
            </div>
            
            <div class="exchange-item">
                <div>ğŸŒ±</div>
                <div class="item-details">
                    <h3>æ¾æ¨¹</h3>
                    <p>æ¯å¹´å¯å¸æ”¶ç´„30kgäºŒæ°§åŒ–ç¢³</p>
                </div>
                <div>
                    <span>40 ç©åˆ†</span>
                    <button onclick="exchangePlant('pine-tree', 40, 'ğŸŒ²')">å…Œæ›</button>
                </div>
            </div>
            
            <div class="exchange-item">
                <div>ğŸŒ±</div>
                <div class="item-details">
                    <h3>ç«¹å­</h3>
                    <p>ç”Ÿé•·å¿«é€Ÿï¼Œå¸æ”¶äºŒæ°§åŒ–ç¢³èƒ½åŠ›å¼·</p>
                </div>
                <div>
                    <span>20 ç©åˆ†</span>
                    <button onclick="exchangePlant('bamboo', 20, 'ğŸ‹')">å…Œæ›</button>
                </div>
            </div>
        </div>
        
        <!-- æ¤ç‰©å¯¶å…¸å€å¡Š -->
        <div id="plantSection" class="section card">
            <h2>æ¤ç‰©å¯¶å…¸</h2>
            <p>å·²æ”¶é›†: <span id="plantCount">0</span>/5</p>
            
            <div class="plant-grid" id="plantGrid">
                <!-- æ¤ç‰©å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
        
        <!-- æ¯æ—¥ä»»å‹™å€å¡Š -->
        <div id="taskSection" class="section card">
            <h2>æ¯æ—¥ä»»å‹™</h2>
            <p>å®Œæˆä»»å‹™ç²å¾—é¡å¤–ç©åˆ†ï¼</p>
            
            <div class="daily-task">
                <input type="checkbox" id="task1" class="task-checkbox" onchange="updateTaskProgress()">
                <label for="task1">è¼¸å…¥ä¸‰ç­†è³‡æ–™ (0/3)</label>
            </div>
            
            <div class="daily-task">
                <input type="checkbox" id="task2" class="task-checkbox" onchange="updateTaskProgress()">
                <label for="task2">æ¸›å°‘ä½¿ç”¨5å€‹ç´™æ¯ (0/5)</label>
            </div>
            
            <div class="daily-task">
                <input type="checkbox" id="task3" class="task-checkbox" onchange="updateTaskProgress()">
                <label for="task3">ä¸€å¤©ä¸ä½¿ç”¨å¡‘è† è¢‹</label>
            </div>
            
            <div>
                <p>ä»Šæ—¥ä»»å‹™å®Œæˆ: <span id="taskProgress">0</span>/3</p>
                <button id="claimTaskReward" disabled onclick="claimTaskReward()">é ˜å–çå‹µ (1 ç©åˆ†)</button>
            </div>
        </div>
    </div>
    
    <script>
        // åˆå§‹åŒ–é é¢
        document.addEventListener('DOMContentLoaded', function() {
            // è¨­å®šä»Šå¤©æ—¥æœŸç‚ºé è¨­å€¼
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('date').value = today;
            document.getElementById('recordDate').value = today;
            
            // å¾æœ¬åœ°å„²å­˜ä¸­è¼‰å…¥è³‡æ–™
            loadFromLocalStorage();
            
            // æ›´æ–°çµ±è¨ˆæ•¸æ“š
            updateStats();
            
            // æ›´æ–°æ¤ç‰©å¯¶å…¸
            updatePlantCollection();
            
            // æ›´æ–°è¨˜éŒ„è¡¨æ ¼
            filterRecords();
        });
        
        // ç¢³æ’æ”¾æ•¸æ“š (kg/å–®ä½)
        const carbonData = {
            'cup': 0.01, // ç´™æ¯
            'bag': 0.006, // å¡‘è† è¢‹
            'spoon': 0.005, // å¡‘è† æ¹¯åŒ™
            'bottle': 0.08, // å¯¶ç‰¹ç“¶
            'straw': 0.0005 // å¡‘è† å¸ç®¡
        };
        
        // é …ç›®åç¨±å°ç…§è¡¨
        const itemNames = {
            'cup': 'ç´™æ¯',
            'bag': 'å¡‘è† è¢‹',
            'spoon': 'å¡‘è† æ¹¯åŒ™',
            'bottle': 'å¯¶ç‰¹ç“¶',
            'straw': 'å¡‘è† å¸ç®¡'
        };
        
        // æ¤ç‰©å°ç…§è¡¨
        const plants = {
            'apple-tree': {
                name: 'è˜‹æœæ¨¹',
                icon: 'ğŸ',
                description: 'æ¯å¹´å¯å¸æ”¶ç´„20kgäºŒæ°§åŒ–ç¢³'
            },
            'oak-tree': {
                name: 'æ©¡æ¨¹',
                icon: 'ğŸŒ³',
                description: 'æ¯å¹´å¯å¸æ”¶ç´„40kgäºŒæ°§åŒ–ç¢³'
            },
            'sunflower': {
                name: 'å‘æ—¥è‘µ',
                icon: 'ğŸŒ»',
                description: 'ç¾éº—çš„èŠ±æœµèƒ½æ·¨åŒ–ç©ºæ°£'
            },
            'pine-tree': {
                name: 'æ¾æ¨¹',
                icon: 'ğŸŒ²',
                description: 'æ¯å¹´å¯å¸æ”¶ç´„30kgäºŒæ°§åŒ–ç¢³'
            },
            'bamboo': {
                name: 'ç«¹å­',
                icon: 'ğŸ‹',
                description: 'ç”Ÿé•·å¿«é€Ÿï¼Œå¸æ”¶äºŒæ°§åŒ–ç¢³èƒ½åŠ›å¼·'
            }
        };
        
        // ç”¨æˆ¶è³‡æ–™
        let userData = {
            records: [],
            totalCarbon: 0,
            points: 0,
            plants: {},
            dailyEntries: 0,
            taskRewardClaimed: false,
            lastTaskDate: ''
        };
        
        // ç›£è½è¨ˆç®—è¡¨å–®æäº¤
        document.getElementById('calculatorForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const itemType = document.getElementById('itemType').value;
            const quantity = parseInt(document.getElementById('quantity').value);
            const date = document.getElementById('date').value;
            
            if (!itemType || !quantity || !date) {
                alert('è«‹å¡«å¯«æ‰€æœ‰æ¬„ä½');
                return;
            }
            
            // è¨ˆç®—ç¢³æ’æ”¾
            const carbonEmission = calculateCarbon(itemType, quantity);
            
            // é¡¯ç¤ºçµæœ
            document.getElementById('carbonResult').textContent = 
                `ä½¿ç”¨ ${quantity} å€‹${itemNames[itemType]}ç”¢ç”Ÿäº† ${carbonEmission.toFixed(3)} kg çš„ç¢³æ’æ”¾ã€‚`;
            
            // ä¿å­˜è¨˜éŒ„
            saveRecord(date, itemType, quantity, carbonEmission);
            
            // æ›´æ–°çµ±è¨ˆ
            updateStats();
            
            // æª¢æŸ¥æ¯æ—¥ä»»å‹™é€²åº¦
            checkDailyTaskProgress();
        });
        
        // è¨ˆç®—ç¢³æ’æ”¾
        function calculateCarbon(itemType, quantity) {
            return carbonData[itemType] * quantity;
        }
        
        // ä¿å­˜è¨˜éŒ„
        function saveRecord(date, itemType, quantity, carbonEmission) {
            const record = {
                date: date,
                itemType: itemType,
                itemName: itemNames[itemType],
                quantity: quantity,
                carbon: carbonEmission
            };
            
            userData.records.push(record);
            userData.totalCarbon += carbonEmission;
            userData.points += Math.floor(carbonEmission);
            
            // æª¢æŸ¥ä»Šå¤©çš„æ•¸æ“šè¼¸å…¥æ¬¡æ•¸
            const today = new Date().toISOString().split('T')[0];
            if (date === today) {
                userData.dailyEntries++;
            }
            
            // ä¿å­˜åˆ°æœ¬åœ°å„²å­˜
            saveToLocalStorage();
            
            // æ›´æ–°è¡¨æ ¼
            filterRecords();
        }
        
        // éæ¿¾è¨˜éŒ„
        function filterRecords() {
            const dateFilter = document.getElementById('recordDate').value;
            const tbody = document.getElementById('recordTableBody');
            tbody.innerHTML = '';
            
            let totalFilteredCarbon = 0;
            
            userData.records.forEach(record => {
                if (!dateFilter || record.date === dateFilter) {
                    const row = document.createElement('tr');
                    
                    const dateCell = document.createElement('td');
                    dateCell.textContent = record.date;
                    row.appendChild(dateCell);
                    
                    const itemCell = document.createElement('td');
                    itemCell.textContent = record.itemName;
                    row.appendChild(itemCell);
                    
                    const quantityCell = document.createElement('td');
                    quantityCell.textContent = record.quantity;
                    row.appendChild(quantityCell);
                    
                    const carbonCell = document.createElement('td');
                    carbonCell.textContent = record.carbon.toFixed(3) + ' kg';
                    row.appendChild(carbonCell);
                    
                    tbody.appendChild(row);
                    
                    totalFilteredCarbon += record.carbon;
                }
            });
            
            document.getElementById('totalCarbon').textContent = totalFilteredCarbon.toFixed(3) + ' kg';
        }
        
        // å…Œæ›æ¤ç‰©
        function exchangePlant(plantId, cost, icon) {
            if (userData.points < cost) {
                alert('ç©åˆ†ä¸è¶³ï¼');
                return;
            }
            
            userData.points -= cost;
            
            if (!userData.plants[plantId]) {
                userData.plants[plantId] = {
                    id: plantId,
                    count: 1,
                    name: plants[plantId].name,
                    icon: plants[plantId].icon,
                    description: plants[plantId].description
                };
            } else {
                userData.plants[plantId].count++;
            }
            
            // ä¿å­˜åˆ°æœ¬åœ°å„²å­˜
            saveToLocalStorage();
            
            // æ›´æ–°çµ±è¨ˆå’Œæ¤ç‰©å¯¶å…¸
            updateStats();
            updatePlantCollection();
            
            alert(`æˆåŠŸå…Œæ› ${plants[plantId].name}ï¼`);
        }
        
        // æ›´æ–°æ¤ç‰©å¯¶å…¸
        function updatePlantCollection() {
            const grid = document.getElementById('plantGrid');
            grid.innerHTML = '';
            
            // å…ˆé¡¯ç¤ºå·²æ”¶é›†çš„æ¤ç‰©
            for (const plantId in userData.plants) {
                const plant = userData.plants[plantId];
                
                const card = document.createElement('div');
                card.className = 'plant-card';
                
                const icon = document.createElement('div');
                icon.className = 'plant-icon';
                icon.textContent = plant.icon;
                
                const name = document.createElement('h3');
                name.textContent = plant.name;
                
                const count = document.createElement('p');
                count.textContent = `æ•¸é‡: ${plant.count}`;
                
                const desc = document.createElement('p');
                desc.textContent = plant.description;
                
                card.appendChild(icon);
                card.appendChild(name);
                card.appendChild(count);
                card.appendChild(desc);
                
                grid.appendChild(card);
            }
            
            // æ·»åŠ æœªæ”¶é›†çš„æ¤ç‰©ï¼ˆåŠé€æ˜ï¼‰
            for (const plantId in plants) {
                if (!userData.plants[plantId]) {
                    const card = document.createElement('div');
                    card.className = 'plant-card';
                    card.style.opacity = '0.5';
                    
                    const icon = document.createElement('div');
                    icon.className = 'plant-icon';
                    icon.textContent = 'â“';
                    
                    const name = document.createElement('h3');
                    name.textContent = 'æœªæ”¶é›†';
                    
                    card.appendChild(icon);
                    card.appendChild(name);
                    
                    grid.appendChild(card);
                }
            }
            
            // æ›´æ–°æ”¶é›†æ•¸é‡
            const collectedCount = Object.keys(userData.plants).length;
            document.getElementById('plantCount').textContent = collectedCount;
        }
        
        // æª¢æŸ¥æ¯æ—¥ä»»å‹™é€²åº¦
        function checkDailyTaskProgress() {
            const today = new Date().toISOString().split('T')[0];
            
            // é‡è¨­ä»»å‹™ï¼ˆå¦‚æœæ˜¯æ–°çš„ä¸€å¤©ï¼‰
            if (userData.lastTaskDate !== today) {
                userData.lastTaskDate = today;
                userData.dailyEntries = countTodayEntries();
                userData.taskRewardClaimed = false;
                document.getElementById('task1').checked = false;
                document.getElementById('task2').checked = false;
                document.getElementById('task3').checked = false;
                document.getElementById('claimTaskReward').disabled = true;
            }
            
            // æ›´æ–°ä»»å‹™1ï¼šè¼¸å…¥ä¸‰ç­†è³‡æ–™
            const task1 = document.getElementById('task1');
            const entriesCount = countTodayEntries();
            task1.nextElementSibling.textContent = `è¼¸å…¥ä¸‰ç­†è³‡æ–™ (${Math.min(entriesCount, 3)}/3)`;
            task1.checked = entriesCount >= 3;
            
            // æ›´æ–°ä»»å‹™2ï¼šæ¸›å°‘ç´™æ¯ä½¿ç”¨
            const task2 = document.getElementById('task2');
            const cupsSavedToday = countTodayItemUsage('cup');
            task2.nextElementSibling.textContent = `æ¸›å°‘ä½¿ç”¨5å€‹ç´™æ¯ (${Math.min(cupsSavedToday, 5)}/5)`;
            task2.checked = cupsSavedToday >= 5;
            
            // ä»»å‹™3ä¿æŒä¸è®Šï¼ˆä¸»è§€å®Œæˆï¼‰
            
            // æ›´æ–°ä»»å‹™é€²åº¦
            updateTaskProgress();
            
            // ä¿å­˜åˆ°æœ¬åœ°å„²å­˜
            saveToLocalStorage();
        }
        
        // è¨ˆç®—ä»Šå¤©çš„è³‡æ–™è¼¸å…¥æ¬¡æ•¸
        function countTodayEntries() {
            const today = new Date().toISOString().split('T')[0];
            return userData.records.filter(record => record.date === today).length;
        }
        
        // è¨ˆç®—ä»Šå¤©æŸé …ç›®çš„ä½¿ç”¨æ•¸é‡
        function countTodayItemUsage(itemType) {
            const today = new Date().toISOString().split('T')[0];
            return userData.records
                .filter(record => record.date === today && record.itemType === itemType)
                .reduce((total, record) => total + record.quantity, 0);
        }
        
        // æ›´æ–°ä»»å‹™é€²åº¦
        function updateTaskProgress() {
            const task1 = document.getElementById('task1').checked;
            const task2 = document.getElementById('task2').checked;
            const task3 = document.getElementById('task3').checked;
            
            const completedTasks = [task1, task2, task3].filter(Boolean).length;
            document.getElementById('taskProgress').textContent = completedTasks;
            
            // å•Ÿç”¨æˆ–ç¦ç”¨çå‹µæŒ‰éˆ•
            const rewardButton = document.getElementById('claimTaskReward');
            rewardButton.disabled = completedTasks < 3 || userData.taskRewardClaimed;
        }
        
        // é ˜å–ä»»å‹™çå‹µ
        function claimTaskReward() {
            if (userData.taskRewardClaimed) {
                alert('æ‚¨ä»Šå¤©å·²ç¶“é ˜å–éçå‹µäº†ï¼');
                return;
            }
            
            userData.points += 1;
            userData.taskRewardClaimed = true;
            
            // ä¿å­˜åˆ°æœ¬åœ°å„²å­˜
            saveToLocalStorage();
            
            // æ›´æ–°çµ±è¨ˆ
            updateStats();
            
            // ç¦ç”¨æŒ‰éˆ•
            document.getElementById('claimTaskReward').disabled = true;
            
            alert('æ­å–œæ‚¨ç²å¾—1é»ç©åˆ†ï¼');
        }
        
        // æ›´æ–°çµ±è¨ˆæ•¸æ“š
        function updateStats() {
            document.getElementById('totalCarbonStat').textContent = userData.totalCarbon.toFixed(1);
            document.getElementById('pointsStat').textContent = userData.points;
            document.getElementById('currentPoints').textContent = userData.points;
            
            const plantsCollected = Object.keys(userData.plants).length;
            document.getElementById('plantsCollectedStat').textContent = plantsCollected;
        }
        
        // åˆ‡æ›å€å¡Šé¡¯ç¤º
        function showSection(sectionId) {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
            document.getElementById(sectionId).classList.add('active');
        }
        
        // ä¿å­˜åˆ°æœ¬åœ°å„²å­˜
        function saveToLocalStorage() {
            localStorage.setItem('ecoTrackerData', JSON.stringify(userData));
        }
        
        // å¾æœ¬åœ°å„²å­˜è¼‰å…¥
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('ecoTrackerData');
            if (savedData) {
                userData = JSON.parse(savedData);
            }
        }
    </script>
</body>
</html>